{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=createAnimatableComponent;var _classCallCheck2=_interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));var _createClass2=_interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));var _assertThisInitialized2=_interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));var _inherits2=_interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));var _possibleConstructorReturn2=_interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));var _getPrototypeOf2=_interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));var _react=_interopRequireWildcard(require(\"react\"));var _propTypes=_interopRequireDefault(require(\"prop-types\"));var _reactNative=require(\"react-native\");var _wrapStyleTransforms=_interopRequireDefault(require(\"./wrapStyleTransforms\"));var _getStyleValues=_interopRequireDefault(require(\"./getStyleValues\"));var _flattenStyle=_interopRequireDefault(require(\"./flattenStyle\"));var _createAnimation=_interopRequireDefault(require(\"./createAnimation\"));var _registry=require(\"./registry\");var _easing=_interopRequireDefault(require(\"./easing\"));var _jsxRuntime=require(\"react/jsx-runtime\");function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!==\"function\")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!==\"object\"&&typeof obj!==\"function\"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!==\"default\"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var INTERPOLATION_STYLE_PROPERTIES=['rotate','rotateX','rotateY','rotateZ','skewX','skewY','transformMatrix','backgroundColor','borderColor','borderTopColor','borderRightColor','borderBottomColor','borderLeftColor','shadowColor','color','textDecorationColor','tintColor'];var ZERO_CLAMPED_STYLE_PROPERTIES=['width','height'];function omit(keys,source){var filtered={};Object.keys(source).forEach(function(key){if(keys.indexOf(key)===-1){filtered[key]=source[key];}});return filtered;}function deepEquals(a,b){return a===b||JSON.stringify(a)===JSON.stringify(b);}function getAnimationTarget(iteration,direction){switch(direction){case'reverse':return 0;case'alternate':return iteration%2?0:1;case'alternate-reverse':return iteration%2?1:0;case'normal':default:return 1;}}function getAnimationOrigin(iteration,direction){return getAnimationTarget(iteration,direction)?0:1;}function getCompiledAnimation(animation){if(typeof animation==='string'){var compiledAnimation=(0,_registry.getAnimationByName)(animation);if(!compiledAnimation){throw new Error(\"No animation registred by the name of \"+animation);}return compiledAnimation;}return(0,_createAnimation.default)(animation);}function makeInterpolatedStyle(compiledAnimation,animationValue){var style={};Object.keys(compiledAnimation).forEach(function(key){if(key==='style'){Object.assign(style,compiledAnimation.style);}else if(key!=='easing'){style[key]=animationValue.interpolate(compiledAnimation[key]);}});return(0,_wrapStyleTransforms.default)(style);}function transitionToValue(property,transitionValue,toValue,duration,easing){var useNativeDriver=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;var delay=arguments.length>6?arguments[6]:undefined;var onTransitionBegin=arguments.length>7?arguments[7]:undefined;var onTransitionEnd=arguments.length>8?arguments[8]:undefined;var animation=duration||easing||delay?_reactNative.Animated.timing(transitionValue,{toValue:toValue,delay:delay,duration:duration||1000,easing:typeof easing==='function'?easing:_easing.default[easing||'ease'],useNativeDriver:useNativeDriver}):_reactNative.Animated.spring(transitionValue,{toValue:toValue,useNativeDriver:useNativeDriver});setTimeout(function(){return onTransitionBegin(property);},delay);animation.start(function(){return onTransitionEnd(property);});}function createAnimatableComponent(WrappedComponent){var _class,_temp;var wrappedComponentName=WrappedComponent.displayName||WrappedComponent.name||'Component';var Animatable=_reactNative.Animated.createAnimatedComponent(WrappedComponent);return _temp=_class=function(_Component){(0,_inherits2.default)(AnimatableComponent,_Component);var _super=_createSuper(AnimatableComponent);function AnimatableComponent(props){var _this;(0,_classCallCheck2.default)(this,AnimatableComponent);_this=_super.call(this,props);_this.ref=null;_this.handleRef=function(ref){_this.ref=ref;};var animationValue=new _reactNative.Animated.Value(getAnimationOrigin(0,_this.props.direction));var animationStyle={};var compiledAnimation={};if(props.animation){compiledAnimation=getCompiledAnimation(props.animation);animationStyle=makeInterpolatedStyle(compiledAnimation,animationValue);}_this.state={animationValue:animationValue,animationStyle:animationStyle,compiledAnimation:compiledAnimation,transitionStyle:{},transitionValues:{},currentTransitionValues:{}};if(props.transition){_this.state=Object.assign({},_this.state,_this.initializeTransitionState(props.transition));}_this.delayTimer=null;(0,_registry.getAnimationNames)().forEach(function(animationName){if(!(animationName in(0,_assertThisInitialized2.default)(_this))){_this[animationName]=_this.animate.bind((0,_assertThisInitialized2.default)(_this),animationName);}});return _this;}(0,_createClass2.default)(AnimatableComponent,[{key:\"initializeTransitionState\",value:function initializeTransitionState(transitionKeys){var transitionValues={};var styleValues={};var currentTransitionValues=(0,_getStyleValues.default)(transitionKeys,this.props.style);Object.keys(currentTransitionValues).forEach(function(key){var value=currentTransitionValues[key];if(INTERPOLATION_STYLE_PROPERTIES.indexOf(key)!==-1||typeof value!=='number'){transitionValues[key]=new _reactNative.Animated.Value(0);styleValues[key]=value;}else{var animationValue=new _reactNative.Animated.Value(value);transitionValues[key]=animationValue;styleValues[key]=animationValue;}});return{currentTransitionValues:currentTransitionValues,transitionStyle:styleValues,transitionValues:transitionValues};}},{key:\"getTransitionState\",value:function getTransitionState(keys){var _this2=this;var transitionKeys=typeof keys==='string'?[keys]:keys;var _this$state=this.state,transitionValues=_this$state.transitionValues,currentTransitionValues=_this$state.currentTransitionValues,transitionStyle=_this$state.transitionStyle;var missingKeys=transitionKeys.filter(function(key){return!_this2.state.transitionValues[key];});if(missingKeys.length){var transitionState=this.initializeTransitionState(missingKeys);transitionValues=Object.assign({},transitionValues,transitionState.transitionValues);currentTransitionValues=Object.assign({},currentTransitionValues,transitionState.currentTransitionValues);transitionStyle=Object.assign({},transitionStyle,transitionState.transitionStyle);}return{transitionValues:transitionValues,currentTransitionValues:currentTransitionValues,transitionStyle:transitionStyle};}},{key:\"setNativeProps\",value:function setNativeProps(nativeProps){if(this.ref){this.ref.setNativeProps(nativeProps);}}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;var _this$props=this.props,animation=_this$props.animation,duration=_this$props.duration,delay=_this$props.delay,onAnimationBegin=_this$props.onAnimationBegin,iterationDelay=_this$props.iterationDelay;if(animation){var startAnimation=function startAnimation(){onAnimationBegin();_this3.startAnimation(duration,0,iterationDelay,function(endState){return _this3.props.onAnimationEnd(endState);});_this3.delayTimer=null;};if(delay){this.delayTimer=setTimeout(startAnimation,delay);}else{startAnimation();}}}},{key:\"UNSAFE_componentWillReceiveProps\",value:function UNSAFE_componentWillReceiveProps(props){var _this4=this;var animation=props.animation,delay=props.delay,duration=props.duration,easing=props.easing,iterationDelay=props.iterationDelay,transition=props.transition,onAnimationBegin=props.onAnimationBegin;if(transition){var values=(0,_getStyleValues.default)(transition,props.style);this.transitionTo(values,duration,easing,delay);}else if(!deepEquals(animation,this.props.animation)){if(animation){if(this.delayTimer){this.setAnimation(animation);}else{onAnimationBegin();this.animate(animation,duration,iterationDelay).then(function(endState){return _this4.props.onAnimationEnd(endState);});}}else{this.stopAnimation();}}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.delayTimer){clearTimeout(this.delayTimer);}}},{key:\"setAnimation\",value:function setAnimation(animation,callback){var compiledAnimation=getCompiledAnimation(animation);this.setState(function(state){return{animationStyle:makeInterpolatedStyle(compiledAnimation,state.animationValue),compiledAnimation:compiledAnimation};},callback);}},{key:\"animate\",value:function animate(animation,duration,iterationDelay){var _this5=this;return new Promise(function(resolve){_this5.setAnimation(animation,function(){_this5.startAnimation(duration,0,iterationDelay,resolve);});});}},{key:\"stopAnimation\",value:function stopAnimation(){this.setState({scheduledAnimation:false,animationStyle:{}});this.state.animationValue.stopAnimation();if(this.delayTimer){clearTimeout(this.delayTimer);this.delayTimer=null;}}},{key:\"startAnimation\",value:function startAnimation(duration,iteration,iterationDelay,callback){var _this6=this;var _this$state2=this.state,animationValue=_this$state2.animationValue,compiledAnimation=_this$state2.compiledAnimation;var _this$props2=this.props,direction=_this$props2.direction,iterationCount=_this$props2.iterationCount,useNativeDriver=_this$props2.useNativeDriver;var easing=this.props.easing||compiledAnimation.easing||'ease';var currentIteration=iteration||0;var fromValue=getAnimationOrigin(currentIteration,direction);var toValue=getAnimationTarget(currentIteration,direction);animationValue.setValue(fromValue);if(typeof easing==='string'){easing=_easing.default[easing];}var reversed=direction==='reverse'||direction==='alternate'&&!toValue||direction==='alternate-reverse'&&!toValue;if(reversed){easing=_reactNative.Easing.out(easing);}var config={toValue:toValue,easing:easing,isInteraction:iterationCount<=1,duration:duration||this.props.duration||1000,useNativeDriver:useNativeDriver,delay:iterationDelay||0};_reactNative.Animated.timing(animationValue,config).start(function(endState){currentIteration+=1;if(endState.finished&&_this6.props.animation&&(iterationCount==='infinite'||currentIteration<iterationCount)){_this6.startAnimation(duration,currentIteration,iterationDelay,callback);}else if(callback){callback(endState);}});}},{key:\"transition\",value:function transition(fromValues,toValues,duration,easing){var _this7=this;var fromValuesFlat=(0,_flattenStyle.default)(fromValues);var toValuesFlat=(0,_flattenStyle.default)(toValues);var transitionKeys=Object.keys(toValuesFlat);var _this$getTransitionSt=this.getTransitionState(transitionKeys),transitionValues=_this$getTransitionSt.transitionValues,currentTransitionValues=_this$getTransitionSt.currentTransitionValues,transitionStyle=_this$getTransitionSt.transitionStyle;transitionKeys.forEach(function(property){var fromValue=fromValuesFlat[property];var toValue=toValuesFlat[property];var transitionValue=transitionValues[property];if(!transitionValue){transitionValue=new _reactNative.Animated.Value(0);}var needsInterpolation=INTERPOLATION_STYLE_PROPERTIES.indexOf(property)!==-1||typeof value!=='number';var needsZeroClamping=ZERO_CLAMPED_STYLE_PROPERTIES.indexOf(property)!==-1;if(needsInterpolation){transitionValue.setValue(0);transitionStyle[property]=transitionValue.interpolate({inputRange:[0,1],outputRange:[fromValue,toValue]});currentTransitionValues[property]=toValue;toValuesFlat[property]=1;}else{if(needsZeroClamping){transitionStyle[property]=transitionValue.interpolate({inputRange:[0,1],outputRange:[0,1],extrapolateLeft:'clamp'});currentTransitionValues[property]=toValue;}else{transitionStyle[property]=transitionValue;}transitionValue.setValue(fromValue);}});this.setState({transitionValues:transitionValues,transitionStyle:transitionStyle,currentTransitionValues:currentTransitionValues},function(){_this7.transitionToValues(toValuesFlat,duration||_this7.props.duration,easing,_this7.props.delay);});}},{key:\"transitionTo\",value:function transitionTo(toValues,duration,easing,delay){var _this8=this;var currentTransitionValues=this.state.currentTransitionValues;var toValuesFlat=(0,_flattenStyle.default)(toValues);var transitions={from:{},to:{}};Object.keys(toValuesFlat).forEach(function(property){var toValue=toValuesFlat[property];var needsInterpolation=INTERPOLATION_STYLE_PROPERTIES.indexOf(property)!==-1||typeof value!=='number';var needsZeroClamping=ZERO_CLAMPED_STYLE_PROPERTIES.indexOf(property)!==-1;var transitionStyle=_this8.state.transitionStyle[property];var transitionValue=_this8.state.transitionValues[property];if(!needsInterpolation&&!needsZeroClamping&&transitionStyle&&transitionStyle===transitionValue){transitionToValue(property,transitionValue,toValue,duration,easing,_this8.props.useNativeDriver,delay,function(prop){return _this8.props.onTransitionBegin(prop);},function(prop){return _this8.props.onTransitionEnd(prop);});}else{var currentTransitionValue=currentTransitionValues[property];if(typeof currentTransitionValue==='undefined'&&_this8.props.style){var style=(0,_getStyleValues.default)(property,_this8.props.style);currentTransitionValue=style[property];}transitions.from[property]=currentTransitionValue;transitions.to[property]=toValue;}});if(Object.keys(transitions.from).length){this.transition(transitions.from,transitions.to,duration,easing);}}},{key:\"transitionToValues\",value:function transitionToValues(toValues,duration,easing,delay){var _this9=this;Object.keys(toValues).forEach(function(property){var transitionValue=_this9.state.transitionValues[property];var toValue=toValues[property];transitionToValue(property,transitionValue,toValue,duration,easing,_this9.props.useNativeDriver,delay,function(prop){return _this9.props.onTransitionBegin(prop);},function(prop){return _this9.props.onTransitionEnd(prop);});});}},{key:\"render\",value:function render(){var _this$props3=this.props,style=_this$props3.style,animation=_this$props3.animation,transition=_this$props3.transition;if(animation&&transition){throw new Error('You cannot combine animation and transition props');}var restProps=omit(['animation','duration','direction','delay','easing','iterationCount','iterationDelay','onAnimationBegin','onAnimationEnd','onTransitionBegin','onTransitionEnd','style','transition','useNativeDriver'],this.props);return(0,_jsxRuntime.jsx)(Animatable,Object.assign({ref:this.handleRef,style:[style,this.state.animationStyle,(0,_wrapStyleTransforms.default)(this.state.transitionStyle)]},restProps));}}]);return AnimatableComponent;}(_react.Component),_class.displayName=\"withAnimatable(\"+wrappedComponentName+\")\",_class.propTypes={animation:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.object]),duration:_propTypes.default.number,direction:_propTypes.default.oneOf(['normal','reverse','alternate','alternate-reverse']),delay:_propTypes.default.number,easing:_propTypes.default.oneOfType([_propTypes.default.oneOf(Object.keys(_easing.default)),_propTypes.default.func]),iterationCount:function iterationCount(props,propName){var val=props[propName];if(val!=='infinite'&&!(typeof val==='number'&&val>=1)){return new Error('iterationCount must be a positive number or \"infinite\"');}return null;},iterationDelay:_propTypes.default.number,onAnimationBegin:_propTypes.default.func,onAnimationEnd:_propTypes.default.func,onTransitionBegin:_propTypes.default.func,onTransitionEnd:_propTypes.default.func,style:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.array,_propTypes.default.object]),transition:_propTypes.default.oneOfType([_propTypes.default.string,_propTypes.default.arrayOf(_propTypes.default.string)]),useNativeDriver:_propTypes.default.bool},_class.defaultProps={animation:undefined,delay:0,direction:'normal',duration:undefined,easing:undefined,iterationCount:1,iterationDelay:0,onAnimationBegin:function onAnimationBegin(){},onAnimationEnd:function onAnimationEnd(){},onTransitionBegin:function onTransitionBegin(){},onTransitionEnd:function onTransitionEnd(){},style:undefined,transition:undefined,useNativeDriver:false},_temp;}","map":{"version":3,"sources":["/Users/uheron/IH/storybookFinalTest/node_modules/react-native-animatable/createAnimatableComponent.js"],"names":["INTERPOLATION_STYLE_PROPERTIES","ZERO_CLAMPED_STYLE_PROPERTIES","omit","keys","source","filtered","Object","forEach","key","indexOf","deepEquals","a","b","JSON","stringify","getAnimationTarget","iteration","direction","getAnimationOrigin","getCompiledAnimation","animation","compiledAnimation","Error","makeInterpolatedStyle","animationValue","style","assign","interpolate","transitionToValue","property","transitionValue","toValue","duration","easing","useNativeDriver","delay","onTransitionBegin","onTransitionEnd","Animated","timing","EASING_FUNCTIONS","spring","setTimeout","start","createAnimatableComponent","WrappedComponent","wrappedComponentName","displayName","name","Animatable","createAnimatedComponent","props","ref","handleRef","Value","animationStyle","state","transitionStyle","transitionValues","currentTransitionValues","transition","initializeTransitionState","delayTimer","animationName","animate","bind","transitionKeys","styleValues","value","missingKeys","filter","length","transitionState","nativeProps","setNativeProps","onAnimationBegin","iterationDelay","startAnimation","endState","onAnimationEnd","values","transitionTo","setAnimation","then","stopAnimation","clearTimeout","callback","setState","Promise","resolve","scheduledAnimation","iterationCount","currentIteration","fromValue","setValue","reversed","Easing","out","config","isInteraction","finished","fromValues","toValues","fromValuesFlat","toValuesFlat","getTransitionState","needsInterpolation","needsZeroClamping","inputRange","outputRange","extrapolateLeft","transitionToValues","transitions","from","to","prop","currentTransitionValue","restProps","Component","propTypes","PropTypes","oneOfType","string","object","number","oneOf","func","propName","val","array","arrayOf","bool","defaultProps","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Animated, Easing } from 'react-native';\nimport wrapStyleTransforms from './wrapStyleTransforms';\nimport getStyleValues from './getStyleValues';\nimport flattenStyle from './flattenStyle';\nimport createAnimation from './createAnimation';\nimport { getAnimationByName, getAnimationNames } from './registry';\nimport EASING_FUNCTIONS from './easing';\n\n// These styles are not number based and thus needs to be interpolated\nconst INTERPOLATION_STYLE_PROPERTIES = [\n  // Transform styles\n  'rotate',\n  'rotateX',\n  'rotateY',\n  'rotateZ',\n  'skewX',\n  'skewY',\n  'transformMatrix',\n  // View styles\n  'backgroundColor',\n  'borderColor',\n  'borderTopColor',\n  'borderRightColor',\n  'borderBottomColor',\n  'borderLeftColor',\n  'shadowColor',\n  // Text styles\n  'color',\n  'textDecorationColor',\n  // Image styles\n  'tintColor',\n];\n\nconst ZERO_CLAMPED_STYLE_PROPERTIES = ['width', 'height'];\n\n// Create a copy of `source` without `keys`\nfunction omit(keys, source) {\n  const filtered = {};\n  Object.keys(source).forEach(key => {\n    if (keys.indexOf(key) === -1) {\n      filtered[key] = source[key];\n    }\n  });\n  return filtered;\n}\n\n// Yes it's absurd, but actually fast\nfunction deepEquals(a, b) {\n  return a === b || JSON.stringify(a) === JSON.stringify(b);\n}\n\n// Determine to what value the animation should tween to\nfunction getAnimationTarget(iteration, direction) {\n  switch (direction) {\n    case 'reverse':\n      return 0;\n    case 'alternate':\n      return iteration % 2 ? 0 : 1;\n    case 'alternate-reverse':\n      return iteration % 2 ? 1 : 0;\n    case 'normal':\n    default:\n      return 1;\n  }\n}\n\n// Like getAnimationTarget but opposite\nfunction getAnimationOrigin(iteration, direction) {\n  return getAnimationTarget(iteration, direction) ? 0 : 1;\n}\n\nfunction getCompiledAnimation(animation) {\n  if (typeof animation === 'string') {\n    const compiledAnimation = getAnimationByName(animation);\n    if (!compiledAnimation) {\n      throw new Error(`No animation registred by the name of ${animation}`);\n    }\n    return compiledAnimation;\n  }\n  return createAnimation(animation);\n}\n\nfunction makeInterpolatedStyle(compiledAnimation, animationValue) {\n  const style = {};\n  Object.keys(compiledAnimation).forEach(key => {\n    if (key === 'style') {\n      Object.assign(style, compiledAnimation.style);\n    } else if (key !== 'easing') {\n      style[key] = animationValue.interpolate(compiledAnimation[key]);\n    }\n  });\n  return wrapStyleTransforms(style);\n}\n\nfunction transitionToValue(\n  property,\n  transitionValue,\n  toValue,\n  duration,\n  easing,\n  useNativeDriver = false,\n  delay,\n  onTransitionBegin,\n  onTransitionEnd,\n) {\n  const animation =\n    duration || easing || delay\n      ? Animated.timing(transitionValue, {\n          toValue,\n          delay,\n          duration: duration || 1000,\n          easing:\n            typeof easing === 'function'\n              ? easing\n              : EASING_FUNCTIONS[easing || 'ease'],\n          useNativeDriver,\n        })\n      : Animated.spring(transitionValue, { toValue, useNativeDriver });\n  setTimeout(() => onTransitionBegin(property), delay);\n  animation.start(() => onTransitionEnd(property));\n}\n\n// Make (almost) any component animatable, similar to Animated.createAnimatedComponent\nexport default function createAnimatableComponent(WrappedComponent) {\n  const wrappedComponentName =\n    WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\n  const Animatable = Animated.createAnimatedComponent(WrappedComponent);\n\n  return class AnimatableComponent extends Component {\n    static displayName = `withAnimatable(${wrappedComponentName})`;\n\n    static propTypes = {\n      animation: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),\n      duration: PropTypes.number,\n      direction: PropTypes.oneOf([\n        'normal',\n        'reverse',\n        'alternate',\n        'alternate-reverse',\n      ]),\n      delay: PropTypes.number,\n      easing: PropTypes.oneOfType([\n        PropTypes.oneOf(Object.keys(EASING_FUNCTIONS)),\n        PropTypes.func,\n      ]),\n      iterationCount(props, propName) {\n        const val = props[propName];\n        if (val !== 'infinite' && !(typeof val === 'number' && val >= 1)) {\n          return new Error(\n            'iterationCount must be a positive number or \"infinite\"',\n          );\n        }\n        return null;\n      },\n      iterationDelay: PropTypes.number,\n      onAnimationBegin: PropTypes.func,\n      onAnimationEnd: PropTypes.func,\n      onTransitionBegin: PropTypes.func,\n      onTransitionEnd: PropTypes.func,\n      style: PropTypes.oneOfType([\n        PropTypes.number,\n        PropTypes.array,\n        PropTypes.object,\n      ]),\n      transition: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.arrayOf(PropTypes.string),\n      ]),\n      useNativeDriver: PropTypes.bool,\n    };\n\n    static defaultProps = {\n      animation: undefined,\n      delay: 0,\n      direction: 'normal',\n      duration: undefined,\n      easing: undefined,\n      iterationCount: 1,\n      iterationDelay: 0,\n      onAnimationBegin() {},\n      onAnimationEnd() {},\n      onTransitionBegin() {},\n      onTransitionEnd() {},\n      style: undefined,\n      transition: undefined,\n      useNativeDriver: false,\n    };\n\n    constructor(props) {\n      super(props);\n\n      const animationValue = new Animated.Value(\n        getAnimationOrigin(0, this.props.direction),\n      );\n      let animationStyle = {};\n      let compiledAnimation = {};\n      if (props.animation) {\n        compiledAnimation = getCompiledAnimation(props.animation);\n        animationStyle = makeInterpolatedStyle(\n          compiledAnimation,\n          animationValue,\n        );\n      }\n      this.state = {\n        animationValue,\n        animationStyle,\n        compiledAnimation,\n        transitionStyle: {},\n        transitionValues: {},\n        currentTransitionValues: {},\n      };\n\n      if (props.transition) {\n        this.state = {\n          ...this.state,\n          ...this.initializeTransitionState(props.transition),\n        };\n      }\n      this.delayTimer = null;\n\n      // Alias registered animations for backwards compatibility\n      getAnimationNames().forEach(animationName => {\n        if (!(animationName in this)) {\n          this[animationName] = this.animate.bind(this, animationName);\n        }\n      });\n    }\n\n    initializeTransitionState(transitionKeys) {\n      const transitionValues = {};\n      const styleValues = {};\n\n      const currentTransitionValues = getStyleValues(\n        transitionKeys,\n        this.props.style,\n      );\n      Object.keys(currentTransitionValues).forEach(key => {\n        const value = currentTransitionValues[key];\n        if (\n          INTERPOLATION_STYLE_PROPERTIES.indexOf(key) !== -1 ||\n          typeof value !== 'number'\n        ) {\n          transitionValues[key] = new Animated.Value(0);\n          styleValues[key] = value;\n        } else {\n          const animationValue = new Animated.Value(value);\n          transitionValues[key] = animationValue;\n          styleValues[key] = animationValue;\n        }\n      });\n\n      return {\n        currentTransitionValues,\n        transitionStyle: styleValues,\n        transitionValues,\n      };\n    }\n\n    getTransitionState(keys) {\n      const transitionKeys = typeof keys === 'string' ? [keys] : keys;\n      let {\n        transitionValues,\n        currentTransitionValues,\n        transitionStyle,\n      } = this.state;\n      const missingKeys = transitionKeys.filter(\n        key => !this.state.transitionValues[key],\n      );\n      if (missingKeys.length) {\n        const transitionState = this.initializeTransitionState(missingKeys);\n        transitionValues = {\n          ...transitionValues,\n          ...transitionState.transitionValues,\n        };\n        currentTransitionValues = {\n          ...currentTransitionValues,\n          ...transitionState.currentTransitionValues,\n        };\n        transitionStyle = {\n          ...transitionStyle,\n          ...transitionState.transitionStyle,\n        };\n      }\n      return { transitionValues, currentTransitionValues, transitionStyle };\n    }\n\n    ref = null;\n\n    handleRef = ref => {\n      this.ref = ref;\n    };\n\n    setNativeProps(nativeProps) {\n      if (this.ref) {\n        this.ref.setNativeProps(nativeProps);\n      }\n    }\n\n    componentDidMount() {\n      const {\n        animation,\n        duration,\n        delay,\n        onAnimationBegin,\n        iterationDelay,\n      } = this.props;\n      if (animation) {\n        const startAnimation = () => {\n          onAnimationBegin();\n          this.startAnimation(duration, 0, iterationDelay, endState =>\n            this.props.onAnimationEnd(endState),\n          );\n          this.delayTimer = null;\n        };\n        if (delay) {\n          this.delayTimer = setTimeout(startAnimation, delay);\n        } else {\n          startAnimation();\n        }\n      }\n    }\n\n    // eslint-disable-next-line camelcase\n    UNSAFE_componentWillReceiveProps(props) {\n      const {\n        animation,\n        delay,\n        duration,\n        easing,\n        iterationDelay,\n        transition,\n        onAnimationBegin,\n      } = props;\n\n      if (transition) {\n        const values = getStyleValues(transition, props.style);\n        this.transitionTo(values, duration, easing, delay);\n      } else if (!deepEquals(animation, this.props.animation)) {\n        if (animation) {\n          if (this.delayTimer) {\n            this.setAnimation(animation);\n          } else {\n            onAnimationBegin();\n            this.animate(animation, duration, iterationDelay).then(endState =>\n              this.props.onAnimationEnd(endState),\n            );\n          }\n        } else {\n          this.stopAnimation();\n        }\n      }\n    }\n\n    componentWillUnmount() {\n      if (this.delayTimer) {\n        clearTimeout(this.delayTimer);\n      }\n    }\n\n    setAnimation(animation, callback) {\n      const compiledAnimation = getCompiledAnimation(animation);\n      this.setState(\n        state => ({\n          animationStyle: makeInterpolatedStyle(\n            compiledAnimation,\n            state.animationValue,\n          ),\n          compiledAnimation,\n        }),\n        callback,\n      );\n    }\n\n    animate(animation, duration, iterationDelay) {\n      return new Promise(resolve => {\n        this.setAnimation(animation, () => {\n          this.startAnimation(duration, 0, iterationDelay, resolve);\n        });\n      });\n    }\n\n    stopAnimation() {\n      this.setState({\n        scheduledAnimation: false,\n        animationStyle: {},\n      });\n      this.state.animationValue.stopAnimation();\n      if (this.delayTimer) {\n        clearTimeout(this.delayTimer);\n        this.delayTimer = null;\n      }\n    }\n\n    startAnimation(duration, iteration, iterationDelay, callback) {\n      const { animationValue, compiledAnimation } = this.state;\n      const { direction, iterationCount, useNativeDriver } = this.props;\n      let easing = this.props.easing || compiledAnimation.easing || 'ease';\n      let currentIteration = iteration || 0;\n      const fromValue = getAnimationOrigin(currentIteration, direction);\n      const toValue = getAnimationTarget(currentIteration, direction);\n      animationValue.setValue(fromValue);\n\n      if (typeof easing === 'string') {\n        easing = EASING_FUNCTIONS[easing];\n      }\n      // Reverse easing if on the way back\n      const reversed =\n        direction === 'reverse' ||\n        (direction === 'alternate' && !toValue) ||\n        (direction === 'alternate-reverse' && !toValue);\n      if (reversed) {\n        easing = Easing.out(easing);\n      }\n      const config = {\n        toValue,\n        easing,\n        isInteraction: iterationCount <= 1,\n        duration: duration || this.props.duration || 1000,\n        useNativeDriver,\n        delay: iterationDelay || 0,\n      };\n\n      Animated.timing(animationValue, config).start(endState => {\n        currentIteration += 1;\n        if (\n          endState.finished &&\n          this.props.animation &&\n          (iterationCount === 'infinite' || currentIteration < iterationCount)\n        ) {\n          this.startAnimation(\n            duration,\n            currentIteration,\n            iterationDelay,\n            callback,\n          );\n        } else if (callback) {\n          callback(endState);\n        }\n      });\n    }\n\n    transition(fromValues, toValues, duration, easing) {\n      const fromValuesFlat = flattenStyle(fromValues);\n      const toValuesFlat = flattenStyle(toValues);\n      const transitionKeys = Object.keys(toValuesFlat);\n      const {\n        transitionValues,\n        currentTransitionValues,\n        transitionStyle,\n      } = this.getTransitionState(transitionKeys);\n\n      transitionKeys.forEach(property => {\n        const fromValue = fromValuesFlat[property];\n        const toValue = toValuesFlat[property];\n        let transitionValue = transitionValues[property];\n        if (!transitionValue) {\n          transitionValue = new Animated.Value(0);\n        }\n        const needsInterpolation =\n          INTERPOLATION_STYLE_PROPERTIES.indexOf(property) !== -1 ||\n          typeof value !== 'number';\n        const needsZeroClamping =\n          ZERO_CLAMPED_STYLE_PROPERTIES.indexOf(property) !== -1;\n        if (needsInterpolation) {\n          transitionValue.setValue(0);\n          transitionStyle[property] = transitionValue.interpolate({\n            inputRange: [0, 1],\n            outputRange: [fromValue, toValue],\n          });\n          currentTransitionValues[property] = toValue;\n          toValuesFlat[property] = 1;\n        } else {\n          if (needsZeroClamping) {\n            transitionStyle[property] = transitionValue.interpolate({\n              inputRange: [0, 1],\n              outputRange: [0, 1],\n              extrapolateLeft: 'clamp',\n            });\n            currentTransitionValues[property] = toValue;\n          } else {\n            transitionStyle[property] = transitionValue;\n          }\n          transitionValue.setValue(fromValue);\n        }\n      });\n      this.setState(\n        { transitionValues, transitionStyle, currentTransitionValues },\n        () => {\n          this.transitionToValues(\n            toValuesFlat,\n            duration || this.props.duration,\n            easing,\n            this.props.delay,\n          );\n        },\n      );\n    }\n\n    transitionTo(toValues, duration, easing, delay) {\n      const { currentTransitionValues } = this.state;\n      const toValuesFlat = flattenStyle(toValues);\n      const transitions = {\n        from: {},\n        to: {},\n      };\n\n      Object.keys(toValuesFlat).forEach(property => {\n        const toValue = toValuesFlat[property];\n        const needsInterpolation =\n          INTERPOLATION_STYLE_PROPERTIES.indexOf(property) !== -1 ||\n          typeof value !== 'number';\n        const needsZeroClamping =\n          ZERO_CLAMPED_STYLE_PROPERTIES.indexOf(property) !== -1;\n        const transitionStyle = this.state.transitionStyle[property];\n        const transitionValue = this.state.transitionValues[property];\n        if (\n          !needsInterpolation &&\n          !needsZeroClamping &&\n          transitionStyle &&\n          transitionStyle === transitionValue\n        ) {\n          transitionToValue(\n            property,\n            transitionValue,\n            toValue,\n            duration,\n            easing,\n            this.props.useNativeDriver,\n            delay,\n            prop => this.props.onTransitionBegin(prop),\n            prop => this.props.onTransitionEnd(prop),\n          );\n        } else {\n          let currentTransitionValue = currentTransitionValues[property];\n          if (\n            typeof currentTransitionValue === 'undefined' &&\n            this.props.style\n          ) {\n            const style = getStyleValues(property, this.props.style);\n            currentTransitionValue = style[property];\n          }\n          transitions.from[property] = currentTransitionValue;\n          transitions.to[property] = toValue;\n        }\n      });\n\n      if (Object.keys(transitions.from).length) {\n        this.transition(transitions.from, transitions.to, duration, easing);\n      }\n    }\n\n    transitionToValues(toValues, duration, easing, delay) {\n      Object.keys(toValues).forEach(property => {\n        const transitionValue = this.state.transitionValues[property];\n        const toValue = toValues[property];\n        transitionToValue(\n          property,\n          transitionValue,\n          toValue,\n          duration,\n          easing,\n          this.props.useNativeDriver,\n          delay,\n          prop => this.props.onTransitionBegin(prop),\n          prop => this.props.onTransitionEnd(prop),\n        );\n      });\n    }\n\n    render() {\n      const { style, animation, transition } = this.props;\n      if (animation && transition) {\n        throw new Error('You cannot combine animation and transition props');\n      }\n      const restProps = omit(\n        [\n          'animation',\n          'duration',\n          'direction',\n          'delay',\n          'easing',\n          'iterationCount',\n          'iterationDelay',\n          'onAnimationBegin',\n          'onAnimationEnd',\n          'onTransitionBegin',\n          'onTransitionEnd',\n          'style',\n          'transition',\n          'useNativeDriver',\n        ],\n        this.props,\n      );\n\n      return (\n        <Animatable\n          ref={this.handleRef}\n          style={[\n            style,\n            this.state.animationStyle,\n            wrapStyleTransforms(this.state.transitionStyle),\n          ]}\n          {...restProps}\n        />\n      );\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"script"}